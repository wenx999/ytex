<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
<properties>
	<entry key="ytex.corpusName">i2b2.2008</entry>
	<entry key="ytex.experiment">@kernel.experiment@</entry>
	<entry key="ytex.param1">@export.cutoff@</entry>
	<!--  <entry key="ytex.param2">@export.param2@</entry> -->
	<entry key="scope">label</entry>
	<entry key="instanceClassQuery"><![CDATA[
	select i.instance_id, j.judgement_id, i.train, d.disease_id, f.fold, f.run
	from cv_fold f
	inner join cv_fold_instance i on f.cv_fold_id = i.cv_fold_id
	inner join i2b2_2008_anno a on a.disease = f.label and a.docId = i.instance_id and a.source = 'intuitive'
	inner join i2b2_2008_disease d on d.disease = a.disease
	inner join i2b2_2008_judgement j on j.judgement = a.judgement
    inner join hotspot_instance hi 
    	on hi.instance_id = i.instance_id
    	and hi.label = a.disease
		and hi.corpus_name = 'i2b2.2008'
		and hi.experiment = 'bag-impcuiword'	
	/* 
	limit to labels that have meaningful training data at this cutoff 
	this means more than one class
	*/
	inner join (
		select disease_id
		from
		(
			select d.disease_id, count(distinct j.judgement_id) jc
			from i2b2_2008_doc doc
			inner join i2b2_2008_anno a on doc.docId = a.docId and a.source = 'intuitive'
			inner join i2b2_2008_disease d on d.disease = a.disease
			inner join i2b2_2008_judgement j on j.judgement = a.judgement
		    inner join hotspot_instance hi 
		    	on hi.instance_id = doc.docId
		    	and hi.label = a.disease
				and hi.corpus_name = 'i2b2.2008'
				and hi.experiment = 'bag-impcuiword'
			left join hotspot_zero_vector hzv
				on hzv.hotspot_instance_id = hi.hotspot_instance_id
				and hzv.cutoff = @export.cutoff@
			where hzv.hotspot_zero_vector_id is null
			and  doc.documentSet = 'train'
		  group by d.disease_id
		) s where jc > 1	
	) dsf on dsf.disease_id = d.disease_id    
	left join hotspot_zero_vector hzv
		on hzv.hotspot_instance_id = hi.hotspot_instance_id
		and hzv.cutoff = @export.cutoff@
	where hzv.hotspot_zero_vector_id is null
	and f.corpus_name = 'i2b2.2008'
	]]></entry>
</properties>
