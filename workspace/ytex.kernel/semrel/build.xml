<!--
-->
<project name="ytex.kernel.sct">
	<property name="ytex.home" value="../.." />
	<include file="${ytex.home}/libs.system/build-classpath.xml" />
	<target name="sct.year.all">
		<for param="sct.year" list="2008,2009,2010,2011">
			<sequential>
				<antcall target="sct.year">
					<param name="sct.year" value="@{sct.year}" />
				</antcall>
			</sequential>
		</for>
	</target>
	<target name="sct.year">
		<property name="sct.year" value="2011" />
		<copy file="snomed-template.xml" tofile="snomed-${sct.year}.xml" overwrite="yes">
			<filterset>
				<filter token="sct.year" value="${sct.year}" />
			</filterset>
		</copy>
		<antcall target="setupConceptGraph">
			<param name="ytex.conceptGraphName" value="snomed-${sct.year}" />
		</antcall>
	</target>
	<target name="setupConceptGraph">
		<java classname="ytex.kernel.dao.ConceptDaoImpl" classpathref="${kernel.cp}" fork="yes" failonerror="yes">
			<syspropertyset>
				<propertyset refid="ytex.jvm.props" />
			</syspropertyset>
			<jvmarg value="-Xmx1g" />
			<arg value="-prop" />
			<arg value="${ytex.conceptGraphName}.xml" />
		</java>
		<java classname="ytex.kernel.IntrinsicInfoContentEvaluatorImpl" classpathref="${kernel.cp}" fork="yes" failonerror="yes">
			<syspropertyset>
				<propertyset refid="ytex.jvm.props" />
			</syspropertyset>
			<jvmarg value="-Xmx1g" />
			<jvmarg value="-Dytex.conceptGraphName=${ytex.conceptGraphName}" />
		</java>
	</target>
	<target name="eval.sim.all">
		<property name="input.files" value="UMNSRS_similarity_cui.txt,UMNSRS_relatedness_cui.txt,MayoSRS_cui.txt,MiniMayoSRS_cui.txt" />
		<for param="eval.concepts" list="${input.files}">
			<sequential>
				<antcall target="eval.sim">
					<param name="eval.concepts" value="@{eval.concepts}" />
				</antcall>
			</sequential>
		</for>
	</target>
	<target name="eval.sim">
		<property name="eval.concepts" value="UMNSRS_similarity_cui.txt" />
		<basename property="eval.base" file="${eval.concepts}" suffix=".txt" />
		<property name="eval.out" value="${eval.base}_sim.txt" />
		<mkdir dir="${basedir}/${ytex.conceptGraphName}" />
		<java classname="ytex.kernel.ConceptSimilarityServiceImpl" classpathref="${kernel.cp}" fork="yes" failonerror="yes">
			<syspropertyset>
				<propertyset refid="ytex.jvm.props" />
			</syspropertyset>
			<jvmarg value="-Xmx1500m" />
			<jvmarg value="-Dytex.conceptGraphName=${ytex.conceptGraphName}" />
			<arg value="-concepts" />
			<arg value="${eval.concepts}" />
			<arg value="-metrics" />
			<arg value="LCH,INTRINSIC_LCH,INTRINSIC_LIN,PATH,INTRINSIC_PATH,JACCARD,SOKAL" />
			<arg value="-out" />
			<arg value="${basedir}/${ytex.conceptGraphName}/${eval.out}" />
		</java>
	</target>
	<target name="sct.eval.sim.all">
		<for param="sct.year" list="2008,2009,2010,2011">
			<sequential>
				<antcall target="sct.eval.sim">
					<param name="sct.year" value="@{sct.year}" />
				</antcall>
			</sequential>
		</for>
	</target>
	<target name="sct.eval.sim">
		<property name="sct.year" value="2011" />
		<antcall target="eval.sim">
			<param name="eval.concepts" value="MiniMayoSRS_snomed_cui.txt" />
			<param name="ytex.conceptGraphName" value="snomed-${sct.year}" />
		</antcall>
	</target>
</project>
